# åŒTouchè®¾å¤‡åŒæœºæ¢°è‡‚æ§åˆ¶ç³»ç»Ÿ - æ„å»ºæŒ‡å—

## æ¦‚è¿°

æœ¬é¡¹ç›®æä¾›äº†ä¸‰ç§ç¼–è¯‘æ–¹å¼ï¼š**CMake**ï¼ˆæ¨èï¼‰ã€**ä¼ ç»ŸMakefile** å’Œ **æ‰‹åŠ¨ç¼–è¯‘**ã€‚

## ğŸš€ æ–¹å¼1: CMakeæ„å»ºï¼ˆæ¨èï¼‰

### ä¼˜ç‚¹
- ç°ä»£åŒ–çš„æ„å»ºç³»ç»Ÿ
- è‡ªåŠ¨æ£€æµ‹ä¾èµ–
- è·¨å¹³å°æ”¯æŒ
- è¯¦ç»†çš„é…ç½®æ£€æŸ¥

### å‰ç½®è¦æ±‚
```bash
# å®‰è£…CMake (ç‰ˆæœ¬3.10+)
sudo apt update
sudo apt install cmake build-essential

# å®‰è£…ä¾èµ–åº“
sudo apt install libncurses5-dev
```

### æ„å»ºæ­¥éª¤

#### 1. é…ç½®é¡¹ç›®
```bash
# åˆ›å»ºæ„å»ºç›®å½•
mkdir build
cd build

# é…ç½®é¡¹ç›®
cmake ..
```

#### 2. ç¼–è¯‘ç¨‹åº
```bash
# ç¼–è¯‘ (ä½¿ç”¨æ‰€æœ‰CPUæ ¸å¿ƒ)
make -j$(nproc)

# æˆ–è€…ä½¿ç”¨cmakeå‘½ä»¤
cmake --build . --parallel
```

#### 3. è¿è¡Œç¨‹åº
```bash
# ä»æ„å»ºç›®å½•è¿è¡Œ
make run

# æˆ–è€…ç›´æ¥è¿è¡Œ
cd ..
./Touch_Controller_Arm
```

### CMakeå¸¸ç”¨å‘½ä»¤

```bash
# æ£€æŸ¥é…ç½®
make check-config

# æ¸…ç†ç¼–è¯‘æ–‡ä»¶
make clean

# å®Œå…¨æ¸…ç†
make clean-all

# å®‰è£…åˆ°ç³»ç»Ÿ
sudo make install

# åˆ›å»ºè½¯ä»¶åŒ…
make package
```

### ä¸åŒæ„å»ºç±»å‹

```bash
# Debugç‰ˆæœ¬
cmake -DCMAKE_BUILD_TYPE=Debug ..
make

# Releaseç‰ˆæœ¬ (é»˜è®¤)
cmake -DCMAKE_BUILD_TYPE=Release ..
make

# æŒ‡å®šè‡ªå®šä¹‰OpenHapticsè·¯å¾„
cmake -DOPENHAPTICS_ROOT_DIR=/custom/path/to/openhaptics ..
```

## ğŸ”§ æ–¹å¼2: ä¼ ç»ŸMakefile

### ä¼˜ç‚¹
- ç®€å•ç›´è§‚
- æ— éœ€é¢å¤–å·¥å…·
- ä¸°å¯Œçš„é¢„å®šä¹‰ç›®æ ‡

### æ„å»ºæ­¥éª¤

#### 1. æ£€æŸ¥ç¯å¢ƒ
```bash
make check
```

#### 2. ç¼–è¯‘ç¨‹åº
```bash
# é»˜è®¤ç¼–è¯‘
make

# æˆ–è€…æ˜¾å¼è°ƒç”¨
make all
```

#### 3. è¿è¡Œç¨‹åº
```bash
make run
```

### Makefileå¸¸ç”¨ç›®æ ‡

```bash
# æ˜¾ç¤ºå¸®åŠ©
make help

# ç¼–è¯‘è°ƒè¯•ç‰ˆæœ¬
make debug

# ç¼–è¯‘å‘å¸ƒç‰ˆæœ¬
make release

# æµ‹è¯•ç¼–è¯‘
make test-compile

# æ¸…ç†æ–‡ä»¶
make clean

# æ£€æŸ¥ç¯å¢ƒ
make check

# å®‰è£…åˆ°ç³»ç»Ÿ
sudo make install

# å¸è½½
sudo make uninstall

# åˆ›å»ºè½¯ä»¶åŒ…
make package

# ä»£ç æ ¼å¼åŒ–
make format
```

## ğŸ› ï¸ æ–¹å¼3: æ‰‹åŠ¨ç¼–è¯‘

### é€‚ç”¨åœºæ™¯
- å¿«é€Ÿæµ‹è¯•
- è‡ªå®šä¹‰ç¼–è¯‘é€‰é¡¹
- å­¦ä¹ ç¼–è¯‘è¿‡ç¨‹

### æ­¥éª¤

#### 1. ç¼–è¯‘conioæ¨¡å—
```bash
gcc -c conio.c -o conio.o
```

#### 2. ç¼–è¯‘ä¸»ç¨‹åº
```bash
g++ -o Touch_Controller_Arm Touch_Controller_Arm.cpp conio.o \
    -I./OpenHaptics/openhaptics_3.4-0-developer-edition-amd64/usr/include \
    -L./OpenHaptics/openhaptics_3.4-0-developer-edition-amd64/usr/lib \
    -lHD -lHDU -lrt -lpthread -lncurses -std=c++11
```

#### 3. è¿è¡Œç¨‹åº
```bash
./Touch_Controller_Arm
```

## ğŸ§ª éªŒè¯æ„å»º

### 1. æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶
```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la Touch_Controller_Arm

# æ£€æŸ¥æ–‡ä»¶æƒé™
file Touch_Controller_Arm

# æ£€æŸ¥ä¾èµ–åº“
ldd Touch_Controller_Arm
```

### 2. å¿«é€Ÿæµ‹è¯•
```bash
# æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ (å¦‚æœæ”¯æŒ)
./Touch_Controller_Arm --version 2>/dev/null || echo "ç¨‹åºå·²ç”Ÿæˆ"

# æ£€æŸ¥é…ç½®æ–‡ä»¶
cat config.ini
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜1: OpenHapticsåº“æœªæ‰¾åˆ°
```
é”™è¯¯: HDåº“æœªæ‰¾åˆ°ï¼è·¯å¾„: ./OpenHaptics/...
```

**è§£å†³æ–¹æ¡ˆ:**
```bash
# æ£€æŸ¥OpenHapticsç›®å½•
ls -la OpenHaptics/

# æ£€æŸ¥åº“æ–‡ä»¶
ls -la OpenHaptics/openhaptics_3.4-0-developer-edition-amd64/usr/lib/

# å¦‚æœè·¯å¾„ä¸åŒï¼Œä¿®æ”¹CMakeLists.txtæˆ–Makefileä¸­çš„è·¯å¾„
```

### å¸¸è§é—®é¢˜2: ncursesåº“æœªæ‰¾åˆ°
```
é”™è¯¯: /usr/bin/ld: cannot find -lncurses
```

**è§£å†³æ–¹æ¡ˆ:**
```bash
# Ubuntu/Debian
sudo apt install libncurses5-dev

# CentOS/RHEL
sudo yum install ncurses-devel

# æˆ–è€…ä½¿ç”¨ncurses6
sudo apt install libncurses-dev
```

### å¸¸è§é—®é¢˜3: ç¼–è¯‘å™¨ç‰ˆæœ¬è¿‡ä½
```
é”™è¯¯: C++11ç‰¹æ€§ä¸æ”¯æŒ
```

**è§£å†³æ–¹æ¡ˆ:**
```bash
# æ£€æŸ¥ç¼–è¯‘å™¨ç‰ˆæœ¬
g++ --version

# å‡çº§ç¼–è¯‘å™¨ (Ubuntu)
sudo apt install gcc-7 g++-7

# æˆ–è€…ä½¿ç”¨clang
sudo apt install clang
export CXX=clang++
```

### å¸¸è§é—®é¢˜4: æƒé™é—®é¢˜
```
é”™è¯¯: æ— æ³•åˆå§‹åŒ–è§¦è§‰è®¾å¤‡
```

**è§£å†³æ–¹æ¡ˆ:**
```bash
# ä½¿ç”¨rootæƒé™è¿è¡Œ
sudo ./Touch_Controller_Arm

# æˆ–è€…æ·»åŠ ç”¨æˆ·åˆ°ç›¸åº”ç»„
sudo usermod -a -G dialout $USER
# æ³¨é”€é‡æ–°ç™»å½•ä½¿ç”Ÿæ•ˆ
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ç¼–è¯‘ä¼˜åŒ–é€‰é¡¹
```bash
# æœ€å¤§ä¼˜åŒ– (Release)
make release
# æˆ–è€…æ‰‹åŠ¨æŒ‡å®š
g++ -O3 -DNDEBUG -march=native ...

# è°ƒè¯•ä¿¡æ¯ (Debug)
make debug
# æˆ–è€…æ‰‹åŠ¨æŒ‡å®š
g++ -g -O0 -DDEBUG ...
```

### å¹¶è¡Œç¼–è¯‘
```bash
# Makefileå¹¶è¡Œç¼–è¯‘
make -j$(nproc)

# CMakeå¹¶è¡Œç¼–è¯‘
cmake --build . --parallel $(nproc)
```

## ğŸ”„ æŒç»­é›†æˆ

### GitHub Actionsç¤ºä¾‹
```yaml
name: Build and Test

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v2
    
    - name: Install dependencies
      run: |
        sudo apt update
        sudo apt install cmake build-essential libncurses5-dev
    
    - name: Configure CMake
      run: cmake -B build -DCMAKE_BUILD_TYPE=Release
    
    - name: Build
      run: cmake --build build --parallel
    
    - name: Test
      run: make -C build check-config
```

## ğŸ“¦ éƒ¨ç½²

### ç³»ç»Ÿå®‰è£…
```bash
# CMakeæ–¹å¼
cd build
sudo make install

# Makefileæ–¹å¼
sudo make install
```

### åˆ›å»ºè½¯ä»¶åŒ…
```bash
# ä½¿ç”¨CMake
cd build
make package

# ä½¿ç”¨Makefile
make package
```

### Dockeréƒ¨ç½²
```dockerfile
FROM ubuntu:20.04

RUN apt-get update && apt-get install -y \
    build-essential \
    cmake \
    libncurses5-dev \
    && rm -rf /var/lib/apt/lists/*

COPY . /app
WORKDIR /app

RUN cmake -B build -DCMAKE_BUILD_TYPE=Release
RUN cmake --build build --parallel

CMD ["./Touch_Controller_Arm"]
```

## ğŸ“‹ æ„å»ºæ£€æŸ¥æ¸…å•

- [ ] OpenHapticsåº“å­˜åœ¨ä¸”è·¯å¾„æ­£ç¡®
- [ ] ç³»ç»Ÿä¾èµ–åº“å·²å®‰è£… (ncurses, pthread)
- [ ] ç¼–è¯‘å™¨æ”¯æŒC++11
- [ ] é…ç½®æ–‡ä»¶å­˜åœ¨æˆ–ä½¿ç”¨é»˜è®¤é…ç½®
- [ ] æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´
- [ ] ç½‘ç»œè¿æ¥æ­£å¸¸ (ç”¨äºæœºæ¢°è‡‚é€šä¿¡)
- [ ] è§¦è§‰è®¾å¤‡å·²è¿æ¥ä¸”é©±åŠ¨æ­£å¸¸

## ğŸ¯ å¿«é€Ÿå¼€å§‹

**æœ€ç®€å•çš„æ„å»ºæ–¹å¼:**
```bash
# 1. æ£€æŸ¥ç¯å¢ƒ
make check

# 2. ç¼–è¯‘è¿è¡Œ
make run
```

**æ¨èçš„æ„å»ºæ–¹å¼:**
```bash
# 1. ä½¿ç”¨CMake
mkdir build && cd build
cmake .. && make -j$(nproc)

# 2. è¿è¡Œç¨‹åº
make run
``` 